<!doctype html>
<html lang="cs">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>BALP v2</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="./css/app.css" rel="stylesheet">

  <style id="vp-fixes">
    #vpModal .modal-header #vp-actions{display:none !important;}
  </style>
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">BALP v2</a>
    <div class="d-flex ms-auto align-items-center gap-2">
      <span id="user-info" class="navbar-text text-white-50">Nepřihlášen</span>
      <button id="btn-login" type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#loginModal">Přihlásit</button>
      <button id="btn-logout" type="button" class="btn btn-outline-light btn-sm d-none">Odhlásit</button>
    </div>
  </div>
</nav>

<div class="container py-3">
  <div id="alert-box" class="alert d-none" role="alert"></div>

  <div class="card shadow-sm">
    <div class="card-body">
      <ul class="nav nav-tabs" id="mainTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-pol" data-bs-toggle="tab" data-bs-target="#pane-pol" type="button" role="tab">Polotovary</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-suroviny" data-bs-toggle="tab" data-bs-target="#pane-suroviny" type="button" role="tab">Suroviny</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-nh" data-bs-toggle="tab" data-bs-target="#pane-nh" type="button" role="tab">NH – Nátěrové Hmoty</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-nh-vyr" data-bs-toggle="tab" data-bs-target="#pane-nh-vyr" type="button" role="tab">Výrobní příkazy NH</button>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="users-tab"
                data-bs-toggle="tab"
                href="#tab-users"
                data-bs-target="#tab-users"
                role="tab"
                aria-controls="tab-users"
                aria-selected="false">Uživatelé</a>
        </li>
        </ul>
    <!-- TAB PANES -->
    <div class="tab-content" id="mainTabsContent">
        <div class="tab-pane fade" id="tab-users" role="tabpanel" aria-labelledby="users-tab">
        <div class="p-3 text-muted">Načítám…</div>
        </div>
    </div>
    
      <div class="tab-content p-3" id="tabContent">
        <div class="tab-pane fade" id="pane-recipes" role="tabpanel">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">Receptury</h5>
            <button class="btn btn-sm btn-outline-secondary" id="btn-reload">Obnovit</button>
          </div>
          <div id="recipes-list" class="small text-muted">Přihlaste se pro načtení dat…</div>
        </div>
        <div class="tab-pane fade" id="pane-dicts" role="tabpanel">
          <div id="dicts-list" class="small text-muted">Přihlaste se pro načtení dat…</div>
        </div>
        <div class="tab-pane fade" id="pane-prices" role="tabpanel">
          <div id="prices-list" class="small text-muted">Přihlaste se pro načtení dat…</div>
        </div>
        <div class="tab-pane fade" id="pane-tables" role="tabpanel">
          <div id="tables-list" class="small text-muted">Přihlaste se pro načtení dat…</div>
        </div>

        <!-- NH – Nátěrové Hmoty -->
        <div class="tab-pane fade" id="pane-nh" role="tabpanel" aria-labelledby="tab-nh">
          <div class="filter-toolbar row g-2 align-items-end mb-3">
            <div class="col-12 col-lg-4">
              <label for="nh-search" class="form-label">Vyhledat položku NH</label>
              <input type="text" class="form-control" id="nh-search" placeholder="Zadejte část názvu nebo kódu…">
            </div>
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-code-from">Číslo od</label>
              <input type="text" class="form-control" id="nh-code-from" placeholder="Např. 1000">
            </div>
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-code-to">Číslo do</label>
              <input type="text" class="form-control" id="nh-code-to" placeholder="Např. 1999">
            </div>
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-active">Platnost</label>
              <select id="nh-active" class="form-select">
                <option value="1" selected>Jen platné</option>
                <option value="">Vše</option>
                <option value="0">Jen neplatné</option>
              </select>
            </div>
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-limit">Záznamů na stránku</label>
              <select id="nh-limit" class="form-select">
                <option>10</option>
                <option>25</option>
                <option selected>50</option>
                <option>100</option>
              </select>
            </div>
            <div class="col-12 col-lg-auto ms-lg-auto">
              <div class="toolbar-actions">
                <button type="button" id="nh-reset" class="btn btn-outline-secondary">Reset filtrů</button>
                <button type="button" id="nh-new" class="btn btn-success">Nová NH</button>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-sm table-striped" id="nh-table">
              <thead>
                <tr>
                  <th scope="col" data-col="id" class="sortable">ID</th>
                  <th scope="col" data-col="cislo" class="sortable">Kód</th>
                  <th scope="col" data-col="cislo_vt" class="sortable">Číslo VP</th>
                  <th scope="col" data-col="nazev" class="sortable">Název</th>
                  <th scope="col" data-col="kategorie_id" class="sortable">Kategorie</th>
                  <th scope="col" data-col="dtod" class="sortable">Platnost od</th>
                  <th scope="col" data-col="dtdo" class="sortable">Platnost do</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="d-flex justify-content-between align-items-center mt-2">
            <div id="nh-meta" class="small text-muted">Přihlaste se pro načtení dat…</div>
            <div class="btn-group" role="group" aria-label="Stránkování">
              <button class="btn btn-outline-secondary" id="nh-prev-bottom">&laquo; Předchozí</button>
              <button class="btn btn-outline-secondary" id="nh-next-bottom">Další &raquo;</button>
            </div>
          </div>
        </div>

        <!-- Výrobní příkazy NH -->
        <div class="tab-pane fade" id="pane-nh-vyr" role="tabpanel" aria-labelledby="tab-nh-vyr">
          <div class="filter-toolbar row g-2 align-items-end mb-3">
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-vyr-od">Číslo VP od</label>
              <input type="text" class="form-control" id="nh-vyr-od" placeholder="00-0000" inputmode="numeric" maxlength="7">
            </div>
            <div class="col-6 col-md-3 col-xl-2">
              <label class="form-label" for="nh-vyr-do">Číslo VP do</label>
              <input type="text" class="form-control" id="nh-vyr-do" placeholder="99-9999" inputmode="numeric" maxlength="7">
            </div>
            <div class="col-12 col-md-3 col-xl-2">
              <label class="form-label" for="nh-vyr-limit">Záznamů na stránku</label>
              <select id="nh-vyr-limit" class="form-select">
                <option>10</option>
                <option>25</option>
                <option selected>50</option>
                <option>100</option>
              </select>
            </div>
            <div class="col-12 col-lg-auto ms-lg-auto">
              <div class="toolbar-actions d-flex flex-wrap gap-2">
                <button type="button" id="nh-vyr-submit" class="btn btn-primary">Zobrazit</button>
                <button type="button" id="nh-vyr-reset" class="btn btn-outline-secondary">Reset</button>
                <button type="button" id="nh-vyr-export-csv" class="btn btn-outline-secondary">Export CSV</button>
                <button type="button" id="nh-vyr-export-pdf" class="btn btn-outline-secondary">Export PDF</button>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-sm table-striped align-middle" id="nh-vyr-table">
              <thead>
                <tr>
                  <th scope="col" data-col="id" class="sortable text-end">ID</th>
                  <th scope="col" data-col="cislo_vp" class="sortable">Číslo VP</th>
                  <th scope="col" data-col="datum_vyroby" class="sortable">Datum výroby</th>
                  <th scope="col" data-col="cislo_nh" class="sortable">Číslo NH</th>
                  <th scope="col" data-col="nazev_nh" class="sortable">Název</th>
                  <th scope="col" data-col="vyrobit_g" class="sortable text-end">Vyrobit (g)</th>
                  <th scope="col">Poznámka</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="d-flex justify-content-between align-items-center mt-2">
            <div id="nh-vyr-meta" class="small text-muted">—</div>
            <div class="btn-group" role="group">
              <button class="btn btn-outline-secondary" id="nh-vyr-prev">&laquo; Předchozí</button>
              <button class="btn btn-outline-secondary" id="nh-vyr-next">Další &raquo;</button>
            </div>
          </div>
        </div>

        <div class="tab-pane fade show active" id="pane-suroviny" role="tabpanel">
          <div class="filter-toolbar row g-2 align-items-end mb-3">
            <div class="col-12 col-lg-4">
              <label for="sur-search" class="form-label">Vyhledat surovinu</label>
              <input type="text" class="form-control" id="sur-search" placeholder="Zadejte část názvu nebo čísla…">
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="sur-filter-olej">Filtrovat olej</label>
              <select id="sur-filter-olej" class="form-select">
                <option value="">Vše</option>
                <option value="1">Jen olejové</option>
                <option value="0">Bez oleje</option>
              </select>
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="sur-filter-platnost">Platnost k datu</label>
              <input type="date" class="form-control" id="sur-filter-platnost" placeholder="YYYY-MM-DD">
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="sur-limit">Záznamů na stránku</label>
              <select id="sur-limit" class="form-select">
                <option>10</option>
                <option>25</option>
                <option selected>50</option>
                <option>100</option>
              </select>
            </div>
            <div class="col-12 col-lg-auto ms-lg-auto">
              <div class="toolbar-actions">
                <button type="button" id="sur-reset" class="btn btn-outline-secondary">Reset filtrů</button>
                <button type="button" id="sur-export" class="btn btn-outline-secondary">Export CSV</button>
                <button type="button" id="sur-new" class="btn btn-success">Nová surovina</button>
              </div>
            </div>
          </div>

          <div class="table-responsive">
            <table class="table table-sm table-hover table-striped align-middle" id="sur-table">
              <thead>
                <tr>
                  <th scope="col" data-col="id" class="sortable">ID</th>
                  <th scope="col" data-col="cislo" class="sortable">Číslo</th>
                  <th scope="col" data-col="nazev" class="sortable">Název</th>
                  <th scope="col" data-col="sh" class="sortable">SH</th>
                  <th scope="col" data-col="okp" class="sortable">OKP</th>
                  <th scope="col" data-col="olej" class="sortable">Olej</th>
                  <th scope="col">Pozn.</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <div class="d-flex justify-content-between align-items-center mt-2">
            <div class="small text-muted" id="sur-summary">—</div>
            <div class="btn-group" role="group">
              <button class="btn btn-outline-secondary btn-sm" id="sur-prev">&laquo; Předchozí</button>
              <button class="btn btn-outline-secondary btn-sm" id="sur-next">Další &raquo;</button>
            </div>
          </div>
        </div>
      
        <div class="tab-pane fade" id="pane-pol" role="tabpanel">
          <div class="filter-toolbar row g-2 align-items-end mb-3">
            <div class="col-12 col-lg-4">
              <label for="pol-search" class="form-label">Vyhledat polotovar</label>
              <input type="text" class="form-control" id="pol-search" placeholder="Zadejte část názvu nebo čísla…">
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="pol-filter-olej">Filtrovat olej</label>
              <select id="pol-filter-olej" class="form-select">
                <option value="">Vše</option>
                <option value="1">Jen olejové</option>
                <option value="0">Bez oleje</option>
              </select>
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="pol-filter-platnost">Platnost k datu</label>
              <input type="date" class="form-control" id="pol-filter-platnost" placeholder="YYYY-MM-DD">
            </div>
            <div class="col-6 col-md-4 col-xl-2">
              <label class="form-label" for="pol-limit">Záznamů na stránku</label>
              <select id="pol-limit" class="form-select">
                <option>10</option>
                <option>25</option>
                <option selected>50</option>
                <option>100</option>
              </select>
            </div>
            <div class="col-12 col-lg-auto ms-lg-auto">
              <div class="toolbar-actions">
                <button type="button" id="pol-reset" class="btn btn-outline-secondary">Reset filtrů</button>
                <button id="pol-new" class="btn btn-success">Nový polotovar</button>
              </div>
            </div>
          </div>

          <div class="table-responsive">
            <table class="table table-sm table-hover table-striped align-middle" id="pol-table">
              <thead>
                <tr>
                  <th scope="col" data-col="id" class="sortable">ID</th>
                  <th scope="col" data-col="cislo" class="sortable">Číslo</th>
                  <th scope="col" data-col="nazev" class="sortable">Název</th>
                  <th scope="col" data-col="sh" class="sortable">SH</th>
                  <th scope="col" data-col="okp" class="sortable">OKP</th>
                  <th scope="col" data-col="olej" class="sortable">Olej</th>
                  <th scope="col">Pozn.</th>
                  <th scope="col" data-col="dtod" class="sortable">Platnost od</th>
                  <th scope="col" data-col="dtdo" class="sortable">Platnost do</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <div class="d-flex justify-content-between align-items-center mt-2">
            <div class="small text-muted" id="pol-summary">—</div>
            <div class="btn-group" role="group">
              <button class="btn btn-outline-secondary btn-sm" id="pol-prev">&laquo; Předchozí</button>
              <button class="btn btn-outline-secondary btn-sm" id="pol-next">Další &raquo;</button>
            </div>
          </div>
        </div>

    </div>
  </div>

  <div class="text-end mt-3">
    <a href="./diag.html" class="link-secondary small">Diagnostika přihlášení</a>
  </div>

  <!-- Detail NH modal -->
  <div class="modal fade" id="nhModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Detail Nátěrové hmoty</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3">
            <div class="col-sm-2">
              <label for="nh-id" class="form-label">ID</label>
              <input type="text" class="form-control" id="nh-id" disabled>
            </div>
            <div class="col-sm-3">
              <label for="nh-kod" class="form-label">Kód</label>
              <input type="text" class="form-control" id="nh-kod" disabled>
              <label for="nh-cislo_vt" class="form-label">Číslo VP</label>
              <input type="text" class="form-control" id="nh-cislo_vt" disabled>
            </div>
            <div class="col-sm-7">
              <label for="nh-nazev" class="form-label">Název</label>
              <input type="text" class="form-control" id="nh-nazev" disabled>
            </div>
            <div class="col-sm-3">
              <label for="nh-kategorie_id" class="form-label">Kategorie</label>
              <input type="number" class="form-control" id="nh-kategorie_id" disabled>
            </div>
            <div class="col-sm-3">
              <label for="nh-dtod" class="form-label">Platnost od</label>
              <input type="date" class="form-control" id="nh-dtod" disabled>
            </div>
            <div class="col-sm-3">
              <label for="nh-dtdo" class="form-label">Platnost do</label>
              <input type="date" class="form-control" id="nh-dtdo" disabled>
            </div>
            <div class="col-12">
              <label for="nh-poznamka" class="form-label">Poznámka</label>
              <textarea id="nh-poznamka" class="form-control" rows="3" disabled></textarea>
            </div>
          </div>

          <div class="mt-4">
            <h6 class="mb-2 text-uppercase text-muted small">Varianty / ODS</h6>
            <div id="nh-ods-container" class="d-flex flex-column gap-3"></div>
          </div>

          <div class="mt-4 d-none" id="nh-recipe-editor">
            <h6 class="mb-2 text-uppercase text-muted small">Aktuální receptura</h6>
            <div class="card border-0 shadow-sm">
              <div class="card-body">
                <div class="row g-2 align-items-end">
                  <div class="col-sm-3">
                    <label for="nh-recipe-type" class="form-label">Typ položky</label>
                    <select id="nh-recipe-type" class="form-select form-select-sm">
                      <option value="sur">Surovina</option>
                      <option value="pol">Polotovar</option>
                      <option value="other">Ostatní</option>
                    </select>
                  </div>
                  <div class="col-sm-3">
                    <label for="nh-recipe-code" class="form-label">Kód</label>
                    <input type="text" id="nh-recipe-code" class="form-control form-control-sm" placeholder="Např. 12345" list="nh-recipe-code-suggestions">
                    <datalist id="nh-recipe-code-suggestions"></datalist>
                  </div>
                  <div class="col-sm-4">
                    <label for="nh-recipe-name" class="form-label">Název</label>
                    <input type="text" id="nh-recipe-name" class="form-control form-control-sm" placeholder="Název položky" list="nh-recipe-name-suggestions">
                    <datalist id="nh-recipe-name-suggestions"></datalist>
                  </div>
                  <div class="col-sm-2">
                    <label for="nh-recipe-amount" class="form-label">g / kg</label>
                    <input type="number" step="0.01" min="0" id="nh-recipe-amount" class="form-control form-control-sm" placeholder="0,00">
                  </div>
                  <div class="col-12 text-end">
                    <button type="button" class="btn btn-sm btn-outline-primary" id="nh-recipe-add">Přidat položku</button>
                  </div>
                </div>
                <div class="table-responsive mt-3">
                  <table class="table table-sm align-middle mb-0" id="nh-recipe-table">
                    <thead class="table-light">
                      <tr>
                        <th style="width: 15%;">Typ</th>
                        <th style="width: 20%;">Kód</th>
                        <th>Název</th>
                        <th class="text-end" style="width: 15%;">g / kg</th>
                        <th style="width: 40px;"></th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                  <div class="text-center text-muted small py-3" id="nh-recipe-empty">Receptura zatím neobsahuje žádné položky.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="me-auto small text-muted" id="nh-detail-meta"></div>
          <div class="btn-group me-2">
            <button type="button" class="btn btn-outline-primary" id="btn-nh-edit">Upravit</button>
            <button type="button" class="btn btn-success d-none" id="btn-nh-save">Uložit</button>
            <button type="button" class="btn btn-outline-danger" id="btn-nh-delete">Smazat</button>
          </div>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zavřít</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="nhVyrModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <div>
            <h5 class="modal-title mb-0">Výrobní příkaz NH</h5>
            <div class="small text-muted" id="nh-vyr-detail-subtitle"></div>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex align-items-center gap-2 mb-3">
            <a href="#" id="nh-vyr-detail-vp" class="fw-semibold text-decoration-none">—</a>
            <button type="button" class="btn btn-sm btn-outline-secondary" id="nh-vyr-detail-copy">Kopírovat</button>
          </div>
          <dl class="row mb-0">
            <dt class="col-sm-4">Datum výroby</dt>
            <dd class="col-sm-8" id="nh-vyr-detail-datum">—</dd>
            <dt class="col-sm-4">Číslo NH</dt>
            <dd class="col-sm-8" id="nh-vyr-detail-nh">—</dd>
            <dt class="col-sm-4">Název NH</dt>
            <dd class="col-sm-8" id="nh-vyr-detail-nazev">—</dd>
            <dt class="col-sm-4">Vyrobit (g)</dt>
            <dd class="col-sm-8" id="nh-vyr-detail-mnozstvi">—</dd>
            <dt class="col-sm-4">Poznámka</dt>
            <dd class="col-sm-8" id="nh-vyr-detail-poznamka">—</dd>
          </dl>
          <div class="mt-4">
            <h6 class="mb-2">Receptura</h6>
            <div class="table-responsive">
              <table class="table table-sm table-striped mb-0" id="nh-vyr-detail-rec-table">
                <thead>
                  <tr>
                    <th scope="col" style="width: 15%;">Typ</th>
                    <th scope="col" style="width: 20%;">Kód</th>
                    <th scope="col">Název</th>
                    <th scope="col" class="text-end" style="width: 15%;">g / kg</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="text-muted small py-2" id="nh-vyr-detail-rec-empty">Žádné položky.</div>
          </div>
          <div class="mt-4">
            <h6 class="mb-2">Laboratorní zkoušky</h6>
            <div class="table-responsive">
              <table class="table table-sm table-striped mb-0" id="nh-vyr-detail-zk-table">
                <thead>
                  <tr>
                    <th scope="col">Parametr</th>
                    <th scope="col" style="width: 20%;">Hodnota</th>
                    <th scope="col" style="width: 15%;">Jednotka</th>
                    <th scope="col">Poznámka</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="text-muted small py-2" id="nh-vyr-detail-zk-empty">Žádné záznamy.</div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="btn-group me-auto" role="group">
            <button type="button" class="btn btn-outline-secondary" id="nh-vyr-detail-export-csv">Export CSV</button>
            <button type="button" class="btn btn-outline-secondary" id="nh-vyr-detail-export-pdf">Export PDF</button>
          </div>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zavřít</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Row action modal (polotovary) -->
  <?php if (file_exists(__DIR__."/pol.row-modal.html")) { include __DIR__."/pol.row-modal.html"; } ?>

<div class="modal fade" id="surModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title">Detail suroviny</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
      </div>
      <div class="modal-body">
<div id="vp-agg-wrap" class="mb-2" style="display:none;">
  <div class="alert alert-secondary py-2">
    <strong>Součet surovin (rekurzivně):</strong>
    <div class="table-responsive mt-2">
      <table class="table table-sm" id="vp-agg-table">
        <thead><tr><th>Číslo</th><th>Název</th><th class="text-end">Celkem navážit (g)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
        <form id="sur-form" class="row g-3">
          <div class="col-3"><label class="form-label">ID</label><input type="number" class="form-control" id="f-id" disabled></div>
          <div class="col-4"><label class="form-label">Číslo</label><input type="text" class="form-control" id="f-cislo" disabled></div>
          <div class="col-5"><label class="form-label">Název</label><input type="text" class="form-control" id="f-nazev" disabled></div>
          <div class="col-3"><label class="form-label">SH</label><input type="number" step="0.001" class="form-control" id="f-sh" disabled></div>
          <div class="col-3"><label class="form-label">Sušina (sh)</label><input type="number" step="0.001" class="form-control" id="f-sus_sh" disabled></div>
          <div class="col-3"><label class="form-label">Sušina (hmot.)</label><input type="number" step="0.001" class="form-control" id="f-sus_hmot" disabled></div>
          <div class="col-3"><label class="form-label">Sušina (obj.)</label><input type="number" step="0.001" class="form-control" id="f-sus_obj" disabled></div>
          <div class="col-3"><label class="form-label">OKP</label><input type="number" step="0.001" class="form-control" id="f-okp" disabled></div>
          <div class="col-3"><label class="form-label">Olej</label><input type="number" class="form-control" id="f-olej" disabled></div>
          <div class="col-6"><label class="form-label">Poznámka</label><input type="text" class="form-control" id="f-pozn" disabled></div>
          <div class="col-6"><label class="form-label">Datum od (dtod)</label><input type="date" class="form-control" id="f-dtod" disabled></div>
          <div class="col-6"><label class="form-label">Datum do (dtdo)</label><input type="date" class="form-control" id="f-dtdo" disabled></div>
        </form>
      </div>
      <div class="modal-footer justify-content-between">
        <div class="text-muted small" id="sur-meta"></div>
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-outline-danger me-auto" id="btn-sur-delete">Smazat</button>
          <button type="button" class="btn btn-outline-secondary" id="btn-sur-clone">Klonovat</button>
          <button type="button" class="btn btn-outline-primary" id="btn-sur-edit">Editovat</button>
          <button type="button" class="btn btn-primary d-none" id="btn-sur-save">Uložit</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
  <div class="ms-auto btn-toolbar" id="vp-actions" role="toolbar"></div><h5 class="modal-title">Přihlášení</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button></div>
      <div class="modal-body">
<div id="vp-agg-wrap" class="mb-2" style="display:none;">
  <div class="alert alert-secondary py-2">
    <strong>Součet surovin (rekurzivně):</strong>
    <div class="table-responsive mt-2">
      <table class="table table-sm" id="vp-agg-table">
        <thead><tr><th>Číslo</th><th>Název</th><th class="text-end">Celkem navážit (g)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
        <form id="login-form">
          <div class="mb-3"><label class="form-label">Uživatel</label><input type="text" class="form-control" id="login-username" autocomplete="username"></div>
          <div class="mb-3"><label class="form-label">Heslo</label><input type="password" class="form-control" id="login-password" autocomplete="current-password"></div>
          <div class="form-text">Token se uloží do localStorage. Server může navíc nastavit cookie <code>balp_token</code>.</div>
        </form>
      </div>
      <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zavřít</button><button type="button" class="btn btn-primary" id="login-submit">Přihlásit</button></div>
    </div>
  </div>
</div>

<script>window.API_URL = window.API_URL || '/balp2/api.php';</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="./js/app.js"></script>
<script src="./js/nh.controller.js"></script>
<script src="./js/nh.vyr.controller.js"></script>
<script src="./js/pol.controller.patch.js"></script>
<!-- Výrobní příkaz modal (auto-injected) -->
<div class="modal fade" id="vpModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title">Výrobní příkaz</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
      </div>
      <div class="modal-body">
<div id="vp-agg-wrap" class="mb-2" style="display:none;">
  <div class="alert alert-secondary py-2">
    <strong>Součet surovin (rekurzivně):</strong>
    <div class="table-responsive mt-2">
      <table class="table table-sm" id="vp-agg-table">
        <thead><tr><th>Číslo</th><th>Název</th><th class="text-end">Celkem navážit (g)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
        <div class="row g-3 align-items-end">
          <div class="col-md-4">
            <label class="form-label">Polotovar</label>
            <input type="text" class="form-control" id="vp-pol-head" disabled>
          </div>
          <div class="col-md-3">
            <label class="form-label">Vyrobit (kg)</label>
            <input type="number" step="0.01" min="0.01" class="form-control" id="vp-mnozstvi" value="1.00">
          </div>
          <div class="col-md-5"></div>
</div>
         <div class="row mt-2">
           <div class="col">
             <div id="vp-actions-bottom" class="btn-toolbar gap-2 flex-wrap"></div>
           </div>
         </div>
    
        <div id="vp-summary" class="row g-3 mt-2">
  <div class="col-md-3"><small class="text-muted d-block">Poznámka</small><div id="vp-poznamka" class="fw-medium text-truncate"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Specifická hmotnost (skutečná)</small><div id="vp-sh-skut" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Specifická hmotnost (spočítaná)</small><div id="vp-sh-calc" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Sušina — hmotnost (%)</small><div id="vp-sus-hmot" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Sušina — objem (%)</small><div id="vp-sus-obj" class="fw-medium"></div></div>
</div>
<hr>
        
      <ul class="nav nav-tabs" id="vpTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="vp-sur-tab" data-bs-toggle="tab" data-bs-target="#vp-tab-sur" type="button" role="tab">Suroviny</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="vp-pol-tab" data-bs-toggle="tab" data-bs-target="#vp-tab-pol" type="button" role="tab">Polotovary</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" type="button" id="vp-users-link">Uživatelé</button>
        </li>
</ul>
      <div class="tab-content mt-2">
        <div class="tab-pane fade show active" id="vp-tab-sur" role="tabpanel" aria-labelledby="vp-sur-tab">
          <div class="table-responsive">
            <table class="table table-sm table-striped" id="vp-table-sur">
              <thead><tr><th>Tech. poř.</th><th>Číslo</th><th>Název</th><th>Platnost od</th><th>Platnost do</th><th class="text-end">SH</th><th class="text-end">Suš.hm %</th><th class="text-end">Suš.obj %</th><th class="text-end">g / kg</th><th class="text-end">Navážit (g)</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="tab-pane fade" id="vp-tab-pol" role="tabpanel" aria-labelledby="vp-pol-tab">
          <div class="table-responsive">
            <table class="table table-sm table-striped" id="vp-table-pol">
              <thead><tr><th>Tech. poř.</th><th>Číslo</th><th>Název</th><th>Platnost od</th><th>Platnost do</th><th class="text-end">SH</th><th class="text-end">Suš.hm %</th><th class="text-end">Suš.obj %</th><th class="text-end">g / kg</th><th class="text-end">Navážit (g)</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zavřít</button>
      </div>
    </div>
  </div>
</div>
<script src="js/pol.vyrobni-prikaz.js"></script>
<script src="js/pol.row-open.js"></script>
<script src="js/pol.vp.core.js"></script>
<!-- Editor receptury (polotovary) -->
<div class="modal fade" id="polEditorModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title">Editor receptury</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zavřít"></button>
      </div>
      <div class="modal-body">
<div id="vp-agg-wrap" class="mb-2" style="display:none;">
  <div class="alert alert-secondary py-2">
    <strong>Součet surovin (rekurzivně):</strong>
    <div class="table-responsive mt-2">
      <table class="table table-sm" id="vp-agg-table">
        <thead><tr><th>Číslo</th><th>Název</th><th class="text-end">Celkem navážit (g)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
        <form id="pol-edit-form" onsubmit="return false;">
          <div class="row g-3">
            <div class="col-md-2"><label class="form-label">ID</label><input id="pe-id" class="form-control" disabled></div>
            <div class="col-md-3"><label class="form-label">Číslo</label><input id="pe-cislo" class="form-control"></div>
            <div class="col-md-4"><label class="form-label">Název</label><input id="pe-nazev" class="form-control"></div>
            <div class="col-md-1"><label class="form-label">SH</label><input id="pe-sh" class="form-control"></div>
            <div class="col-md-1"><label class="form-label">OKP</label><input id="pe-okp" class="form-control"></div>
            <div class="col-md-1"><label class="form-label">Olej</label><input id="pe-olej" class="form-control"></div>
            <div class="col-12"><label class="form-label">Poznámka</label><input id="pe-poz" class="form-control"></div>
          </div>
          <div id="vp-summary" class="row g-3 mt-2">
  <div class="col-md-3"><small class="text-muted d-block">Poznámka</small><div id="vp-poznamka" class="fw-medium text-truncate"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Specifická hmotnost (skutečná)</small><div id="vp-sh-skut" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Specifická hmotnost (spočítaná)</small><div id="vp-sh-calc" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Sušina — hmotnost (%)</small><div id="vp-sus-hmot" class="fw-medium"></div></div>
  <div class="col-md-2"><small class="text-muted d-block">Sušina — objem (%)</small><div id="vp-sus-obj" class="fw-medium"></div></div>
</div>
<hr>
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="mb-0">Položky receptury</h6>
            <div class="btn-group">
              <button class="btn btn-sm btn-outline-primary" id="pe-add-sur">Přidat surovinu</button>
              <button class="btn btn-sm btn-outline-secondary" id="pe-add-pol">Přidat polotovar</button>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-sm align-middle" id="pe-table">
              <thead><tr><th>Typ</th><th>Kód / název</th><th>Tech.poř.</th><th class="text-end">g / kg</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <div class="me-auto">
          <button class="btn btn-outline-danger" id="pe-delete">Smazat</button>
          <button class="btn btn-outline-secondary" id="pe-clone">Klonovat</button>
        </div>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Zavřít</button>
        <button class="btn btn-primary" id="pe-save">Uložit</button>
      </div>
    </div>
  </div>
</div>
<script src="js/pol.editor.js"></script>
  <script src="./js/pol.row-modal.js"></script>
</body>
</html>
